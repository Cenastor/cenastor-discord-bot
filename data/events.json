[null,{"name":"Multiple Bot Owners","temp":"","event-type":"1","_id":"weEij","actions":[{"comment":"For DBM Version 1.3.0+","color":"#0bf416","name":"Comment"},{"storage":"3","varName":"owners","name":"Create List"},{"comment":"items in this list are bot owners","color":"#00ff00","name":"Comment"},{"storage":"3","varName":"owners","addType":"0","position":"","value":"\"498687373085769739\"","name":"Add Item to List"},{"storage":"3","varName":"owners","addType":"0","position":"","value":"\"userid2\"","name":"Add Item to List"},{"storage":"3","varName":"owners","addType":"0","position":"","value":"\"userid3\"","name":"Add Item to List"},{"comment":"This Run Script alters the standard check conditions function","color":"#ff0000","name":"Comment"},{"behavior":"1","interpretation":"1","code":"// Created by General Wrex, if any questions arise please\n// find me on DBM Raw Data #support channel.\nlet owners = globalVars(\"owners\");\nowners.push(Files.data.settings.ownerId)\n\nActions.checkConditions = function(msg, cmd) {\n\tconst isServer = Boolean(msg.guild && msg.member);\n\tconst restriction = parseInt(cmd.restriction);\n\tconst permissions = cmd.permissions;\n\tswitch(restriction) {\n\t\tcase 0:\n\t\t\tif(isServer) {\n\t\t\t\treturn this.checkPermissions(msg, permissions);\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\tcase 1:\n\t\t\treturn isServer && this.checkPermissions(msg, permissions);\n\t\tcase 2:\n\t\t\treturn isServer && msg.guild.owner === msg.member;\n\t\tcase 3:\n\t\t\treturn !isServer;\n\t\tcase 4:\n\t\t\treturn owners.length > 0 && owners.includes(msg.author.id)\n\t\tdefault:\n\t\t\treturn true;\n\t}\n};\n\nconsole.log('[Overwrites](Multiple Bot Owners) Actions.checkConditions Loaded');","storage":"0","varName":"","name":"Run Script"}]},{"name":"LoadServerPrefixes","temp":"","event-type":"1","_id":"LoadSubs","actions":[{"behavior":"1","interpretation":"0","code":"// Make sure it only runs once!!\n//------------\n\nif(!globalVars(\"server_prefixes_loaded\")){ \n  this.callNextAction(cache);\n  this.storeValue(true, 3,\"server_prefixes_loaded\", cache);\n}","storage":"0","varName":"","name":"Run Script"},{"behavior":"0","interpretation":"0","code":"Bot.prefixes = {};\nconsole.log('(Server Prefixes) Initiating Server Prefixes....');\nBot.checkCommand = function(msg) {\n\tconst fs = require(\"fs\");\n\tconst path = require(\"path\");\n\n\ttry {\n\t\tconst defaultTag = Files.data.settings.tag;\n\t\tconst separator = Files.data.settings.separator || '\\\\s+';\n\t\n\t\tlet content = msg.content;\n\t\tlet guild = msg.guild;\n\t\n\t\tcontent = content.split(new RegExp(separator))[0];\n\t\n\t\tconst filePath = path.join(\"data\",\"serverPrefixes.json\");\t\t\n\t\tif(fs.existsSync(filePath)){\n\t\t\tlet saved_prefixes = fs.readFileSync(filePath, \"utf8\");\n\t\t\ttry {\n\t\t\t\tthis.prefixes = JSON.parse(saved_prefixes);\t\t\n\t\t\t} catch(err){}\t\t\t\n\t\t}else{\n\t\t\tthis.prefixes[guild.id] = defaultTag;\n\t\t\tfs.writeFileSync(filePath, JSON.stringify(this.prefixes));\n\t\t}\n\n\t\tlet tag = this.prefixes[guild.id] || defaultTag;\n\n                if(Array.isArray(this.prefixes)){ \n                  console.log(\"Old version serverPrefixes.json detected.  Please remove serverPrefixes.json and restart your bot otherwise setting new prefixes will not work!\")\n                  tag = defaultTag;\n                }\n\n\t\tif(tag){\t\n\t\t\tif(guild) guild.tag = tag;\t\n\n\t\t\tif(content.startsWith(tag)) {\t\t\t\t\n\t\t\t\tlet command = content.substring(tag.length);\n\t\t\t\tif(command) {       \n\t\t\t\t\tif(!Bot._caseSensitive) {\n\t\t\t\t\t\tcommand = command.toLowerCase();\n\t\t\t\t\t}\n\t\t\t\t\tconst cmd = Bot.$cmds[command];\n\t\t\t\t\tif(cmd) {\t\t\t\t\t\n\t\t\t\t\t\tActions.preformActions(msg, cmd);\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n   \n};\nconsole.log('(Server Prefixes) Loaded Function Overwrite: CheckCommand');\n","storage":"0","varName":"","name":"Run Script"}]},{"name":"BotStart","temp":"","event-type":"1","actions":[{"info":"1","find":"console-log","storage":"1","varName":"send","name":"Find Channel"},{"channel":"5","varName":"send","message":"Bot Startup Sucsessful! You can now use my commands!","storage":"0","varName2":"","name":"Send Message"},{"server":"0","varName":"","info":"1","storage":"1","varName2":"505906663295942680","name":"Store Server Info"}],"_id":"jNTSy"},{"name":"botjoinserver","temp":"","event-type":"4","_id":"FOZmM","actions":[{"info":"3","storage":"3","varName2":"totalguilds","name":"Store Bot Client Info"},{"info":"4","storage":"3","varName2":"totalusers","name":"Store Bot Client Info"},{"info":"10","storage":"3","varName2":"totalchannels","name":"Store Bot Client Info"},{"info":"32","storage":"3","varName2":"totalcommands","name":"Store Bot Client Info"},{"activity":"3","nameText":"${globalVars(\"totalguilds\")} Servers! ${globalVars(\"totalusers\")} Users! with ${globalVars(\"totalchannels\")} channels ${globalVars(\"totalcommands\")} Cmds!","url":"http://twitch.tv/cenastoryn","stat":"0","name":"Set Bot Activity"}]},{"name":"botleaveserver","temp":"","event-type":"5","_id":"Ahlfs","actions":[{"server":"0","varName":"","info":"2","storage":"1","varName2":"serverjoined","name":"Store Server Info"},{"server":"0","varName":"","info":"5","storage":"1","varName2":"servericon","name":"Store Server Info"},{"server":"0","varName":"","info":"11","storage":"1","varName2":"srvrowner","name":"Store Server Info"},{"server":"0","varName":"","info":"1","storage":"1","varName2":"srvr id","name":"Store Server Info"},{"server":"0","varName":"","info":"2","storage":"1","varName2":"srvrname","name":"Store Server Info"},{"info":"0","find":"504790238078697483","storage":"1","varName":"bots","name":"Find Server"},{"server":"1","varName":"bots","info":"11","storage":"1","varName2":"name","name":"Store Server Info"},{"info":"3","storage":"3","varName2":"totalguilds","name":"Store Bot Client Info"},{"info":"4","storage":"3","varName2":"totalusers","name":"Store Bot Client Info"},{"info":"10","storage":"3","varName2":"totalchannels","name":"Store Bot Client Info"},{"info":"32","storage":"3","varName2":"totalcommands","name":"Store Bot Client Info"},{"activity":"3","nameText":"${globalVars(\"totalguilds\")} Servers! ${globalVars(\"totalusers\")} Users! with ${globalVars(\"totalchannels\")} channels ${globalVars(\"totalcommands\")} Cmds!","url":"http://twitch.tv/cenastoryn","stat":"0","name":"Set Bot Activity"},{"title":"Bot just left ${tempVars(\"srvrname\")}","author":"","color":"RED","timestamp":"true","url":"","authorIcon":"","imageUrl":"","thumbUrl":"","storage":"1","varName":"msg","name":"Create Embed Message"},{"storage":"1","varName":"msg","fieldName":"Owner: ","message":"${tempVars(\"srvrowner\")}","inline":"0","name":"Add Embed Field"},{"storage":"1","varName":"msg","fieldName":"Server ID","message":"${tempVars(\"srvr id\")}","inline":"0","name":"Add Embed Field"},{"storage":"1","varName":"msg","message":"Bot has left the server **${tempVars(\"serverjoined\")}**\n\nServer Icon: [Here](${tempVars(\"servericon\")})\n\n","name":"Set Embed Description"},{"server":"1","varName":"bots","name":"Change Server"},{"info":"0","find":"505906663295942680","storage":"1","varName":"bot","name":"Find Channel"},{"storage":"1","varName":"msg","channel":"5","varName2":"bot","name":"Send Embed Message"},{"name":"End Action Sequence"}]},{"name":"messages_switch","permissions":"NONE","restriction":"1","actions":[{"info":"3","storage":"3","varName2":"totalguilds","name":"Store Bot Client Info"},{"info":"4","storage":"3","varName2":"totalusers","name":"Store Bot Client Info"},{"info":"10","storage":"3","varName2":"totalchannels","name":"Store Bot Client Info"},{"info":"32","storage":"3","varName2":"totalcommands","name":"Store Bot Client Info"},{"server":"0","varName":"","info":"2","storage":"2","varName2":"members.human","name":"Store Server Info"},{"comment":"Change the time below to what ever you would like.","color":"#ff0000","name":"Comment"},{"storage":"1","varName":"messagetime","changeType":"0","value":"240","name":"Control Variable"},{"activity":"3","nameText":"${globalVars(\"totalguilds\")} Servers! ${globalVars(\"totalusers\")} Users! with ${globalVars(\"totalchannels\")} channels ${globalVars(\"totalcommands\")} Cmds!","url":"http://twitch.tv/cenastoryn","stat":"0","name":"Set Bot Activity"},{"time":"${tempVars(\"messagetime\")}","measurement":"1","name":"Wait"},{"activity":"3","nameText":"${globalVars(\"totalguilds\")} Servers! ${globalVars(\"totalusers\")} Users! with ${globalVars(\"totalchannels\")} channels ${globalVars(\"totalcommands\")} Cmds!","url":"http://twitch.tv/one6fire","stat":"0","name":"Set Bot Activity"},{"comment":"Create more with the incased blocks copy and repeat","color":"#ff0000","name":"Comment"},{"time":"${tempVars(\"messagetime\")}","measurement":"1","name":"Wait"},{"activity":"1","nameText":"the ${globalVars(\"totalcommands\")} commands that i have!","url":"","stat":"0","name":"Set Bot Activity"},{"comment":"------------------------------------------------------------------------------","color":"#ff0000","name":"Comment"},{"time":"${tempVars(\"messagetime\")}","measurement":"1","name":"Wait"},{"activity":"2","nameText":"${globalVars(\"totalguilds\")} Servers! ${globalVars(\"totalusers\")} Users! with ${globalVars(\"totalchannels\")} channels ${globalVars(\"totalcommands\")} Cmds!","url":"","stat":"0","name":"Set Bot Activity"},{"time":"${tempVars(\"messagetime\")}","measurement":"1","name":"Wait"},{"storage":"2","varName":"members.human","comparison":"4","value":"1","iftrue":"2","iftrueVal":"1","iffalse":"2","iffalseVal":"1","name":"Check Variable"}],"event-type":"1","_id":"HNRjA"},{"name":"reactionGet","temp":"msgReaction","event-type":"28","_id":"zimku","actions":[{"reaction":"1","varName":"msgReaction","info":"0","storage":"1","varName2":"messageRct","name":"Store Reaction Info"},{"behavior":"1","interpretation":"1","code":"const reaction = tempVars('msgReaction');\nconst msgRct = tempVars('messageRct');\nconst rectarray = globalVars('reactionRoleInf');\nvar usrWhoReacted = reaction.users.last();\nconst _this = this;\nvar messageSent = 'Successfully added the role {roleName} in {server}'; \nvar interval;\nvar arrayNum;\n\n// Setings\n\nconst dmUserAfter = true; // Default, can be changed to false\n\n//\n\nasync function checkRoles() {\n\tif (usrWhoReacted.id != client.user.id) {\n\t\tif (usrWhoReacted.data('cooldownData.reactionMenu') != 1) {\n\t\t\tfor (i = 0; i < rectarray.length; i++) {\n\t\t\t\tif (rectarray[i][msgRct.id] != null) {\n                    arrayNum = i;\n\t\t\t\t\tvar newArr = rectarray[i][msgRct.id];\n\t\t\t\t\tfor (io = 0; io < newArr.length; io++) {\n\t\t\t\t\t\tif (newArr[io][0] == reaction.emoji.name) {\n\t\t\t\t\t\t\tvar newUsr = await msgRct.guild.fetchMember(usrWhoReacted);\n\t\t\t\t\t\t\tvar checkRole = await msgRct.guild.roles.get(newArr[io][1])\n\t\t\t\t\t\t\tif (checkRole != null) {\n\t\t\t\t\t\t\t\tif (newUsr.roles.has(newArr[io][1])) {\n                                    usrWhoReacted.setData('cooldownData.reactionMenu', '1');\n\t\t\t\t\t\t\t\t\tvar tempThing = globalVars('reactionRoleInf');\n\t\t\t\t\t\t\t\t\ttempThing[i][msgRct.id][3] = await reaction.users.array();\n                                    _this.storeValue(tempThing, 3, 'reactionRoleInf', cache)\n                                    interval = setInterval(resetTimer, 1000)\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n                                    usrWhoReacted.setData('cooldownData.reactionMenu', '1');\n\t\t\t\t\t\t\t\t\tvar tempThing = globalVars('reactionRoleInf');\n\t\t\t\t\t\t\t\t\ttempThing[i][msgRct.id][3] = await reaction.users.array();\n\t\t\t\t\t\t\t\t\t_this.storeValue(tempThing, 3, 'reactionRoleInf', cache)\n\t\t\t\t\t\t\t\t\tnewUsr.addRole(newArr[io][1]);\n\t\t\t\t\t\t\t\t\tif (dmUserAfter) {\n                                        messageSent = messageSent.replace(/{roleName}/g, newArr[io][2]);\n                                        messageSent = messageSent.replace(/{server}/g, msgRct.guild.name);\n\t\t\t\t\t\t\t\t\t\tnewUsr.send(messageSent);\n                                    }\n                                    interval = setInterval(resetTimer, 1000)\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n                                var newArray = rectarray.filter(someItem => {\n                                    someItem.hasOwnProperty(msgRct.id) != true\n                                })\n                                _this.storeValue(newArray, 3, 'reactionRoleInf', cache);\n                                _this.storeValue(JSON.stringify(newArray), 3, 'tempData', cache);\n\t\t\t\t\t\t\t\tmsgRct.edit({\n\t\t\t\t\t\t\t\t\tembed: {\n\t\t\t\t\t\t\t\t\t\tcolor: 0xff0000,\n\t\t\t\t\t\t\t\t\t\ttitle: \"Role Reaction Menu\",\n\t\t\t\t\t\t\t\t\t\tdescription: `An error has occured.\\nOne of the roles, role name - ${newArr[io][2]} does not exist anymore.\\nIn turn, this embed has now shutdown.\\nPlease remake the embed.`,\n\t\t\t\t\t\t\t\t\t\ttimestamp: new Date()\n\t\t\t\t\t\t\t\t\t}\n                                });\n                                _this.callNextAction(cache);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n            usrWhoReacted.setData('cooldownData.reactionMenu', '0');\n        }\n\t}\n\n}\n\nfunction resetTimer() {\n    usrWhoReacted.setData('cooldownData.reactionMenu', '0');\n    clearInterval(interval);\n}\n\ncheckRoles();","storage":"0","varName":"","name":"Run Script"},{"storage":"3","varName":"tempData","name":"Save Variable"}]},{"name":"reactionRev","temp":"msgReaction","event-type":"29","_id":"ZQmhC","actions":[{"reaction":"1","varName":"msgReaction","info":"0","storage":"1","varName2":"messageRct","name":"Store Reaction Info"},{"behavior":"1","interpretation":"1","code":"const reaction = tempVars('msgReaction');\nconst msgRct = tempVars('messageRct');\nconst rectarray = globalVars('reactionRoleInf');\nvar usrWhoReacted = reaction.users.array();\nconst _this = this;\nvar messageSent = 'Successfully added the role {roleName} in {server}'; \n// The only variables that work rn, {rolename} and {server}\nvar actualUser;\n// Setings\n\nconst dmUserAfter = true; // Default, can be changed to false\n\n//\n\nasync function checkRoles() {\n\tfor (i = 0; i < rectarray.length; i++) {\n\t\tif (rectarray[i][msgRct.id] != null) {\n            arrayNum = i;\n\t\t\tif (rectarray[i][msgRct.id][3] != null) {\n\t\t\t\tusrWhoReacted = rectarray[i][msgRct.id][3].filter(val => !usrWhoReacted.includes(val))[0];\n\t\t\t\tif (usrWhoReacted != null) {\n\t\t\t\t\tif (usrWhoReacted.data('cooldownData.reactionMenu') != 1) {\n\t\t\t\t\t\tvar newArr = rectarray[i][msgRct.id];\n\t\t\t\t\t\tfor (io = 0; io < newArr.length; io++) {\n\t\t\t\t\t\t\tif (newArr[io][0] == reaction.emoji.name) {\n\t\t\t\t\t\t\t\tvar newUsr = await msgRct.guild.fetchMember(usrWhoReacted);\n\t\t\t\t\t\t\t\tvar checkRole = await msgRct.guild.roles.get(newArr[io][1]);\n\t\t\t\t\t\t\t\tif (checkRole != null) {\n\t\t\t\t\t\t\t\t\tif (!newUsr.roles.has(newArr[io][1])) {\n                                        usrWhoReacted.setData('cooldownData.reactionMenu', '1');\n                                        var tempThing = globalVars('reactionRoleInf');\n\t\t\t\t\t\t\t\t\t    tempThing[i][msgRct.id][3] = await reaction.users.array();\n                                        _this.storeValue(tempThing, 3, 'reactionRoleInf', cache);\n                                        interval = setInterval(resetTimer, 1000);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else {\n                                        var tempThing = globalVars('reactionRoleInf');\n                                        usrWhoReacted.setData('cooldownData.reactionMenu', '1');\n\t\t\t\t\t\t\t\t\t\ttempThing[i][msgRct.id][3] = await reaction.users.array();\n\t\t\t\t\t\t\t\t\t\t_this.storeValue(tempThing, 3, 'reactionRoleInf', cache)\n\t\t\t\t\t\t\t\t\t\tnewUsr.removeRole(newArr[io][1]);\n\t\t\t\t\t\t\t\t\t\tif (dmUserAfter) {\n\t\t\t\t\t\t\t\t\t\t\tmessageSent = messageSent.replace(/{roleName}/g, newArr[io][2]);\n                                            messageSent = messageSent.replace(/{server}/g, msgRct.guild.name);\n\t\t\t\t\t\t\t\t\t\t    newUsr.send(messageSent);\n                                        }\n                                        interval = setInterval(resetTimer, 1000);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n                                    var newArray = rectarray.filter(someItem => {\n                                        someItem.hasOwnProperty(msgRct.id) != true\n                                    })\n                                    _this.storeValue(newArray, 3, 'reactionRoleInf', cache);\n                                    _this.storeValue(JSON.stringify(newArray), 3, 'tempData', cache);\n\t\t\t\t\t\t\t\t\tmsgRct.edit({\n\t\t\t\t\t\t\t\t\t\tembed: {\n\t\t\t\t\t\t\t\t\t\t\tcolor: 0xff0000,\n\t\t\t\t\t\t\t\t\t\t\ttitle: \"Role Reaction Menu\",\n\t\t\t\t\t\t\t\t\t\t\tdescription: `An error has occured.\\nOne of the roles, role name - ${newArr[io][2]} does not exist anymore.\\nIn turn, this embed has now shutdown.\\nPlease remake the embed.`,\n\t\t\t\t\t\t\t\t\t\t\ttimestamp: new Date()\n\t\t\t\t\t\t\t\t\t\t}\n                                    });\n                                    _this.callNextAction(cache);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n                        usrWhoReacted.setData('cooldownData.reactionMenu', '0');\n                    }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nfunction resetTimer() {\n    usrWhoReacted.setData('cooldownData.reactionMenu', '0');\n    clearInterval(interval);\n}\n\ncheckRoles();","storage":"0","varName":"","name":"Run Script"},{"storage":"3","varName":"tempData","name":"Save Variable"}]},{"name":"reactionStart","temp":"","event-type":"1","_id":"Lwriz","actions":[{"storage":"3","varName":"reactionRoleInf","changeType":"0","value":"[]","name":"Control Variable"},{"behavior":"0","interpretation":"1","code":"const _this = this;\nconst fs = require('fs');\nvar someArray = [];\nvar someNum = 0;\nvar globalData;\nvar interval;\n\nfs.readFile('./data/globalVars.json', function read(err, data) {\n    if (err) {\n        throw err;\n    }\n    var savedVars = JSON.parse(data);\n    \n    if (savedVars.hasOwnProperty('tempData')) {\n        var newThing = savedVars.tempData.replace(/[\\\\]/g,'');\n        try {\n            _this.storeValue(JSON.parse(newThing), 3, 'reactionRoleInf', cache);\n            console.log('Saved reactionRoleInf');\n        } catch (e) {\n            console.log('Invalid JSON - Saved Vars')\n        }\n    }\n\n    if(fs.existsSync('./resources/serverRoleMenu.json')) {\n        fs.readFile('./resources/serverRoleMenu.json', async function read(err, data) {\n            if (err) {\n                throw err;\n            }\n            var DataToLoop = JSON.parse(data);\n            globalData = DataToLoop;\n            for (var key in DataToLoop) {\n                if (DataToLoop.hasOwnProperty(key)) {\n                    await someArray.push(DataToLoop[key]);\n                }\n            }\n            interval = setInterval(fetchMessages, 2000);\n        })\n\n    } else {\n        fs.writeFile(\"./resources/serverRoleMenu.json\", \"{}\", function(err) {\n            if(err) {\n                return console.log(err);\n            }\n        });\n    }\n});\n\nfunction fetchMessages() {\n if (someNum != someArray.length) {\n     var channelToFetch = client.channels.get(someArray[someNum]);\n     if (channelToFetch != null) {\n        channelToFetch.fetchMessages({ limit: 100 });\n        console.log(`Fetched messages in channel id ${someArray[someNum]}`);\n        someNum = someNum + 1;\n     } else {\n        delete globalData[someArray[someNum]];\n        fs.writeFile(\"./resources/serverRoleMenu.json\", JSON.stringify(globalData), function(err) {\n            if(err) {\n                return console.log(err);\n            }\n        }); \n     }\n } else {\n    console.log('Finished fetching messages from all logged servers.')\n    clearInterval(interval);\n }\n}","storage":"0","varName":"","name":"Run Script"}]}]